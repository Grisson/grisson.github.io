name: Scheduled Auto-Merge

on:
  push:
    branches:
      - grisson
  # schedule:
  #   # This runs every 5 minutes
  #   - cron: '*/5 * * * *'
  # Allows you to run it manually for testing
  workflow_dispatch: 

jobs:
  merge-branches:
    runs-on: ubuntu-latest
    permissions:
      contents: write # Required to push the merge back to the repo

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0 # Fetches all history so it can merge properly

      - name: Configure Git
        run: |
          git config --global user.name 'github-actions[bot]'
          git config --global user.email 'github-actions[bot]@users.noreply.github.com'

      - name: Merge Branch into Main
        run: |
          # Replace 'dev-branch' with the name of the branch you want to merge FROM
          git checkout main
          git merge origin/grisson --no-ff -m "Automated merge from dev-branch"
          git push origin main